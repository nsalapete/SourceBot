FROM python:3.11-slim

WORKDIR /app

# Install unzip + sqlite
RUN apt-get update && apt-get install -y unzip sqlite3 && apt-get clean

# Copy ZIP file into the image (not into GitHub)
COPY data/Retail.zip /app/Retail.zip

# Unzip into /app/data
RUN mkdir -p /app/data && unzip Retail.zip -d /app/data

# Create SQLite DB and import CSV files
RUN sqlite3 retail.db <<EOF
.mode csv
.import /app/data/retail_inventory_snapshot_30_10_25.csv inventory
.import /app/data/retail_sales_data_01_09_2023_to_31_10_2025.csv sales
EOF

# Default command: open SQLite
CMD ["sqlite3", "retail.db"]
